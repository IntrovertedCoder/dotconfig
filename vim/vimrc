let mapleader = " "

" Line numbers
set number relativenumber

" Colors
colorscheme monokai-bold
syntax on

" Stop scrolling to bottom of window
set scrolloff=5

" Search options
set hlsearch
hi Search ctermbg=81
nnoremap <leader>q :noh<CR>

" Chaning .swp, .bak, and undo location
set directory^=$HOME/.vim/swp//
set backupdir^=$HOME/.vim/bak//
set undodir^=$HOME/.vim/undo//
set undofile

" Adding undotree to space+u
nnoremap <silent><leader>u :UndotreeToggle<CR> :wincmd h<CR> :vertical resize 30<CR>

" Remove trailing whitespace
autocmd BufWritePre * :%s/\s\+$//e

" Show git commit that added line
map <silent><Leader>g :call setbufvar(winbufnr(popup_atcursor(systemlist("cd " . shellescape(fnamemodify(resolve(expand('%:p')), ":h")) . " && git log --no-merges -n 1 -L " . shellescape(line("v") . "," . line(".") . ":" . resolve(expand("%:p")))), { "padding": [1,1,1,1], "pos": "botleft", "wrap": 0 })), "&filetype", "git")<CR>

"Set space+s to substitute the word under the cursor
nmap <leader>r :%s/\<<C-r><C-w>\>//gI<Left><Left><Left>

" Tab management
set softtabstop=4 shiftwidth=4
set expandtab
set autoindent
let g:indentLine_char_list = ['|', '¦', '┆', '┊']
retab

" Better word wrapping to prevent words from being split in the middle
set linebreak

" Weather
map <F2> :!weather <CR>

" Add line at letter 80 for pep8 compliance
set colorcolumn=80
highlight ColorColumn ctermbg=232

" Python stuffz
" For anything other then WSL use 3.8 or 3.7
augroup pythonStuffz
    au BufEnter *.py38 map <F7> <esc>:w\|!python38.exe "%"<CR>
    au BufEnter *.py37 map <F7> <esc>:w\|!python37.exe "%"<CR>
    au BufEnter *.py36 map <F7> <esc>:w\|!python36.exe "%"<CR>
    au BufEnter *.py35 map <F7> <esc>:w\|!python35.exe "%"<CR>
    " Default python editor
    au BufEnter *.py map <F7> <esc>:w\|!python3.8.8 "%"<CR>
augroup END

augroup filetypePython
    au BufNewFile,BufRead *.py38 set filetype=python
    au BufNewFile,BufRead *.py37 set filetype=python
    au BufNewFile,BufRead *.py36 set filetype=python
    au BufNewFile,BufRead *.py35 set filetype=python
augroup END

au BufEnter *.c map <F7> <esc>:w\|!c "%"<CR>

"Which window is selected
nnoremap <silent><leader>h :wincmd h<CR>
nnoremap <silent><leader>j :wincmd j<CR>
nnoremap <silent><leader>k :wincmd k<CR>
nnoremap <silent><leader>l :wincmd l<CR>

" Resizing windows (Leader + ctrl + yuio)
nnoremap <silent><leader><C-u> :resize -2<CR>
nnoremap <silent><leader><C-i> :resize +2<CR>
nnoremap <silent><leader><C-y> :vertical resize -2<CR>
nnoremap <silent><leader><C-o> :vertical resize +2<CR>

"File explorer
nnoremap <silent><leader>e :Lex<CR> :vertical resize 30<CR>

" Enabling spellcheck
nnoremap <silent><leader>c :set spell<CR>

" Yank line
nnoremap <silent><leader>y ^<C-v>$y

"Split window
nnoremap <silent><F3> :wincmd v<CR>
nnoremap <silent><F4> :split<CR>

" Commenting and uncommenting
nnoremap <silent><leader>w ^<S-i># <Esc><Esc>h
nnoremap <silent><leader>s ^xx
        "Comment and move
        nnoremap <silent><leader>[ ^<S-i># <Esc><Esc>hk
        nnoremap <silent><leader>] ^xk
        nnoremap <silent><leader>; ^<S-i># <Esc><Esc>hj
        nnoremap <silent><leader>' ^xj

" Quickly insert an empty new line without entering insert mode
nnoremap <<silent>Leader>o o<Esc>
nnoremap <<silent>Leader>O O<Esc>

" Unmapping ex mode
nnoremap Q <nop>

" Status line settings
set statusline=
set statusline+=%#PmenuSel#
set statusline+=\ %M
set statusline+=\ %r
set statusline+=\ %F
set statusline+=%= " Right side settings
set statusline+=\ %l:%L
set statusline+=\ %p%%
set laststatus=2  " Enable status line for all files

" See invisible characters
set list listchars=tab:>\ ,trail:+,eol:$

" Get current song (Space + F2)
map <silent><leader><F2> :!deadbeef-vs --nowplaying "\%a - \%t"<CR>

set visualbell
set title

"Open files/create files
nnoremap <silent><F11> :vertical wincmd f<CR>
nnoremap <silent><F12> :wincmd f<CR>
nnoremap <silent><leader>gf :e <cfile><CR>

" Colorizer keybinds
nnoremap <silent><leader>m :ColorToggle<CR>
nnoremap <silent><leader>8 :RGB2Term #
nnoremap <silent><leader>9 :Term2RGB<SPACE>
